!function(t){t.widget("Template.DND_OTM",t.Template.DND,{_init:function(){this._super(),this.options.functionList=["resetDnd","enableOption","resetOption","disableOption","unfreezeDnd","freezeDnd","checkAnswer","showAnswer","getElementPostion"],this.dndData.type=this.constants.ONE_TO_MANY,this.resetDnd()},handleOneToMany:function(i,a){var s,e,n=[];void 0===this.dndData.containerDiv?(t(a.helper).css("left",this.dndData.objPosition[t(a.helper).attr("id")].left),t(a.helper).css("top",this.dndData.objPosition[t(a.helper).attr("id")].top)):(s=this.dndData.targetDiv.attr("id"),e=this.dndData.containerDiv.attr("id"),void 0===this.dndData.dragItemPosList[e]&&(this.dndData.dragItemPosList[e]=[]),n=this.dndData.dragItemPosList[e],n.push(s),this.dndData.objPosition[this.dndData.targetDiv.attr("id")].dropAt=this.dndData.containerDiv,this.dndData.objPosition[this.dndData.containerDiv.attr("id")].droppedItem=this.dndData.targetDiv,this.arrangeDragItemPosition(n,this.dndData.containerDiv),this.dndData.targetDiv=void 0,this.dndData.containerDiv=void 0)},arrangeDragItemPosition:function(i,a){var s=0,e=0,n=0;for(e=parseFloat(t(a).css("left")),n=parseFloat(t(a).css("top")),s=0;s<i.length;s+=1)targetDiv=t("#"+i[s],this.options.parentDiv),targetDiv.css("position","absolute"),this.options.widgetData.align===this.constants.VERTICAL_ALIGN||void 0===this.options.widgetData.align?n+targetDiv.height()>t(a).height()+parseFloat(t(a).css("top"))&&(e=parseFloat(t(a).css("left"))+targetDiv.width(),n=parseFloat(t(a).css("top"))):e+targetDiv.width()>t(a).width()+parseFloat(t(a).css("left"))&&(e=parseFloat(t(a).css("left")),n=parseFloat(t(a).css("top"))+targetDiv.height()),targetDiv.css("left",e+"px"),targetDiv.css("top",n+"px"),this.options.widgetData.align===this.constants.VERTICAL_ALIGN||void 0===this.options.widgetData.align?(e=e,n+=targetDiv.height()):(e+=targetDiv.width(),n=n)},rearrangeDroppedItem:function(i,a){var s,e=[];void 0===this.dndData.dragItemPosList[a]&&(this.dndData.dragItemPosList[a]=[]),e=this.dndData.dragItemPosList[a],s=e.indexOf(i),s>-1&&e.splice(s,1),this.arrangeDragItemPosition(e,t("#"+a,this.options.parentDiv))},checkAnswerInOneTwoMany:function(){var t,i,a=this,s=this.options.widgetData.correctList,e=!0,n=[],o=[],r={};void 0===this.options.widgetData.groupMatch||this.options.widgetData.groupMatch===!1?_.each(s,function(s,r){if(i=a.dndData.dragItemPosList[r],void 0!==i)for(i.length!==s.length&&(e=!1),t=0;t<i.length;t+=1)s[t]!==i[t]?(e=!1,o.push(i[t])):n.push(i[t]);else e=!1}):_.each(s,function(s,r){if(i=a.dndData.dragItemPosList[r],void 0!==i)for(i.length!==s.length&&(e=!1),t=0;t<i.length;t+=1)s.indexOf(i[t])<0?(e=!1,o.push(i[t])):n.push(i[t]);else e=!1}),r.correctList=n,r.incorrectList=o,r.isCorrect=e,this.dispatchEvent(this.constants.ON_ANSWER_CHECKED,{},r)},showAnswer:function(){var i,a=this,s=this.options.widgetData.correctList;_.each(s,function(s,e){i=t("#"+e,a.options.parentDiv),a.arrangeDragItemPosition(s,i)})},resetDnd:function(){this._super(),this.dndData.dragItemPosList={}},destroy:function(){this._super()}})}(jQuery);
